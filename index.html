<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>주간 파티 예약판 (3파티 / 정원 4~8)</title>
  <style>
    :root{--bg:#0b0f14;--card:#121821;--muted:#8aa1b2;--accent:#64a9ff;--ok:#2ecc71;--warn:#ffb84d;--danger:#ff6b6b;--line:#1f2a36}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Pretendard,Apple SD Gothic Neo,'Noto Sans KR','Malgun Gothic',sans-serif;background:var(--bg);color:#e6eef5}
    .wrap{max-width:1200px;margin:24px auto;padding:0 16px}
    h1{font-size:22px;margin:0 0 10px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:14px}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    label{font-size:14px;color:var(--muted)} input,select,button{height:36px;border-radius:10px;border:1px solid var(--line);background:#0f141b;color:#e6eef5;padding:0 10px}
    button{cursor:pointer}
    button.primary{background:var(--accent);border-color:transparent;color:#00172e;font-weight:700}
    .grid{overflow:auto;border:1px solid var(--line);border-radius:14px}
    table{width:100%;border-collapse:separate;border-spacing:0;min-width:900px}
    th,td{border-right:1px solid var(--line);border-bottom:1px solid var(--line);padding:8px;vertical-align:top}
    th:first-child,td:first-child{border-left:1px solid var(--line)}
    thead th{position:sticky;top:0;background:#0f141b;font-weight:700}
    tbody tr:first-child td{border-top:1px solid var(--line)}
    .time{white-space:nowrap;color:#bcd0df}
    .party{display:grid;grid-template-columns:1fr auto;gap:6px;padding:8px;border:1px solid var(--line);border-radius:10px;margin-bottom:8px;background:#0e131a}
    .p-head{display:flex;gap:8px;align-items:center}
    .badge{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid var(--line);color:#bcd0df}
    .count{font-weight:700}
    .names{font-size:12px;color:#cfe3f2;line-height:1.4}
    .btns{display:flex;gap:6px}
    .btn-join{background:#21354a;color:#cfe3f2}
    .btn-leave{background:#2a1b1b;color:#ffd5d5;border-color:#512b2b}
    .full{border-color:#3a2a12;background:#1a1410}
    .full .count{color:var(--warn)}
    .muted{color:var(--muted)}
    .foot{margin-top:10px;color:var(--muted);font-size:12px}
    .ok{color:var(--ok)} .danger{color:var(--danger)}
    .hint{font-size:12px;color:#99b2c7}
    .flex-gap{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>주간 파티 예약판 <span class="hint">(같은 시간대 최대 3파티 · 정원 4~8)</span></h1>
    <div class="card" style="margin-bottom:12px">
      <div class="row">
        <div class="flex-gap">
          <label>별명/닉네임</label>
          <input id="nick" placeholder="인게임 닉네임" style="width:180px" />
          <button id="saveNick" class="primary">닉네임 저장</button>
        </div>
        <div class="flex-gap">
          <label>주간 시작일(월요일)</label>
          <input type="date" id="weekStart" />
          <button id="goWeek" class="primary">해당 주 보기</button>
        </div>
        <div class="flex-gap">
          <label>정원</label>
          <select id="capacity">
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8" selected>8</option>
          </select>
          <span class="hint">(이 주의 기본정원 · 관리자가 바꿀 수 있음)</span>
        </div>
      </div>
      <div class="foot">Tip: 닉네임을 저장하면 클릭 한 번으로 참가/취소가 됩니다. 같은 시간대에는 파티 1~3 중 한 곳만 참여되도록 설계되었습니다.</div>
    </div>

    <div class="card" style="margin-bottom:12px">
      <div class="flex-gap">
        <label>시간대 편집</label>
        <input id="timesInput" placeholder="예: 20:00,22:00" style="width:240px">
        <button id="applyTimes">시간대 적용</button>
      </div>
      <div class="foot">쉼표로 구분해 원하는 시간대를 추가/삭제하세요.</div>
    </div>

    <div class="grid" id="grid"></div>

    <div class="foot" style="margin-top:12px">
      ⚙️ 무료 호스팅: GitHub Pages · 데이터: Firebase Firestore(익명 로그인).  
      보안 규칙과 배포 방법은 이 파일 상단 주석/설명서를 확인하세요.
    </div>
  </div>

  <!-- Firebase SDKs (v10) -->
  <script type="module">
    // 🔑 Firebase 웹앱 구성: 콘솔에서 발급받은 값으로 교체
    const firebaseConfig = {
      apiKey: "AIzaSyBa0Lo3qikOS495BmX4JAew63QF7h5FnC0",
      authDomain: "party-reservation.firebaseapp.com",
      projectId: "party-reservation",
      storageBucket: "party-reservation.firebasestorage.app",
      messagingSenderId: "566891379159",
      appId: "1:566891379159:web:8d69d4996dd859a295f392",
      measurementId: "G-XQBDVLWEJD"
    };

    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
    import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';
    import { getFirestore, doc, getDoc, setDoc, updateDoc, onSnapshot, runTransaction } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // 이하 로직 동일 (파티 예약/취소, UI 렌더링, 트랜잭션 처리 등)
    // ... (캔버스에 올린 원본 코드 내용 그대로 유지)
  </script>
</body>
</html>
